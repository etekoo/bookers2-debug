<div class="container">
  <div class="row">
    <div class="col-md-3">
      <!-- ユーザー詳細 -->
      <%= render partial: 'books/user_info', locals: { user: @user } %>

      <!-- 投稿フォーム -->
      <%= render partial: 'books/form', locals: { book: @book } %>
      <div>
        <%= flash[:notice] %>
      </div>

      <% if flash.now[:error].present? %>
        <div>
          <% flash.now[:error].each do |error_message| %>
            <p><%= error_message %></p>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="col-md-8 offset-md-1">
      <!-- 投稿詳細 -->
      <h2>Book detail</h2>
      <div class="row">
      <table>
        <tr>
          <td>
            <%= link_to image_tag(@post.user.get_profile_image(100, 100)), user_path(@post.user) %><br>
            <%= link_to @post.user.name, user_path(@post.user) %>
          </td>
          <td><%= @post.title %></td>
          <td><%= @post.body %></td>
          <td>
            <!-- いいね -->
            <% if @post.favorited_by?(current_user) %>
              <p>
                <%= link_to book_favorite_path(@post, @post.favorites.find_by(user: current_user)), method: :delete, class: "btn btn-sm btn-danger" do %>
                  <span class="glyphicon glyphicon-heart"></span> <%= @post.favorites.count %> ♥
                <% end %>
              </p>
            <% else %>
              <p>
                <%= link_to book_favorites_path(@post), method: :post, class: "btn btn-sm btn-primary" do %>
                  <span class="glyphicon glyphicon-heart-empty"></span> <%= @post.favorites.count %> ♥
                <% end %>
              </p>
            <% end %>
          </td>
          <td>
            <% if @post.user == current_user %>
              <%= link_to "Edit", edit_book_path(@post), method: :get, class: "btn btn-sm btn-success" %>
            <% end %>
          </td>
          <td>
            <% if @post.user == current_user %>
              <%= link_to "Destroy", @post, method: :delete, data: { confirm: "本当に削除しますか？" }, class:"btn btn-sm btn-danger" %>
            <% end %>
          </td>
        </tr>
      </table>
      </div>
    </div>
  </div>
</div>




